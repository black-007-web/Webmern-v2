{"ast":null,"code":"import React,{useEffect,useState}from'react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const User=()=>{const[user,setUser]=useState(null);const[books,setBooks]=useState([]);const fetchUserData=async()=>{try{const token=localStorage.getItem('token');const res=await axios.get('/api/users/me',{headers:{Authorization:`Bearer ${token}`}});setUser(res.data.user);setBooks(res.data.books);}catch(err){console.error(err);}};const handleDelete=async bookId=>{try{const token=localStorage.getItem('token');await axios.delete(`/api/users/books/${bookId}`,{headers:{Authorization:`Bearer ${token}`}});setBooks(books.filter(b=>b._id!==bookId));}catch(err){console.error(err);}};const handleLogout=()=>{localStorage.removeItem('token');window.location.href='/login';};useEffect(()=>{fetchUserData();},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"user-profile\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"User Dashboard\"}),user&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Name:\"}),\" \",user.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Email:\"}),\" \",user.email]})]}),/*#__PURE__*/_jsx(\"h3\",{children:\"Purchased Books\"}),/*#__PURE__*/_jsx(\"ul\",{children:books.map(book=>/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"img\",{src:book.image,alt:book.title,width:\"50\"}),/*#__PURE__*/_jsx(\"strong\",{children:book.title}),\" by \",book.author,/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(book._id),children:\"\\u274C Remove\"})]},book._id))}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,children:\"\\uD83D\\uDEAA Logout\"})]});};export default User;","map":{"version":3,"names":["React","useEffect","useState","axios","jsx","_jsx","jsxs","_jsxs","User","user","setUser","books","setBooks","fetchUserData","token","localStorage","getItem","res","get","headers","Authorization","data","err","console","error","handleDelete","bookId","delete","filter","b","_id","handleLogout","removeItem","window","location","href","className","children","name","email","map","book","src","image","alt","title","width","author","onClick"],"sources":["C:/Users/HAZARY/Downloads/mern-web/mern-library/client/src/pages/User.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\n\r\nconst User = () => {\r\n  const [user, setUser] = useState(null);\r\n  const [books, setBooks] = useState([]);\r\n\r\n  const fetchUserData = async () => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      const res = await axios.get('/api/users/me', {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      setUser(res.data.user);\r\n      setBooks(res.data.books);\r\n    } catch (err) {\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (bookId) => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      await axios.delete(`/api/users/books/${bookId}`, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      setBooks(books.filter((b) => b._id !== bookId));\r\n    } catch (err) {\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    localStorage.removeItem('token');\r\n    window.location.href = '/login';\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchUserData();\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"user-profile\">\r\n      <h2>User Dashboard</h2>\r\n      {user && (\r\n        <div>\r\n          <p><strong>Name:</strong> {user.name}</p>\r\n          <p><strong>Email:</strong> {user.email}</p>\r\n        </div>\r\n      )}\r\n      <h3>Purchased Books</h3>\r\n      <ul>\r\n        {books.map((book) => (\r\n          <li key={book._id}>\r\n            <img src={book.image} alt={book.title} width=\"50\" />\r\n            <strong>{book.title}</strong> by {book.author}\r\n            <button onClick={() => handleDelete(book._id)}>‚ùå Remove</button>\r\n          </li>\r\n        ))}\r\n      </ul>\r\n      <button onClick={handleLogout}>üö™ Logout</button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default User;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}