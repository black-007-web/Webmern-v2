{"ast":null,"code":"import React,{useEffect,useState}from'react';import axios from'axios';import\"../styles.css\";// Make sure this includes updated neon styles\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BookList=()=>{const[books,setBooks]=useState([]);const[filteredBooks,setFilteredBooks]=useState([]);const[message,setMessage]=useState('');const[messageType,setMessageType]=useState('');const[search,setSearch]=useState('');const[suggestions,setSuggestions]=useState([]);const[selectedGenre,setSelectedGenre]=useState('All');const fetchBooks=async()=>{try{const res=await axios.get('https://api-fable-forest.onrender.com/api/books');setBooks(res.data);setFilteredBooks(res.data);}catch(err){console.error('Error fetching books:',err);}};const handleBuy=async bookId=>{try{const token=localStorage.getItem('token');if(!token){setMessage('⚠️ You must be logged in to purchase a book.');setMessageType('error');return;}await axios.post('https://api-fable-forest.onrender.com/api/user/buy',{bookId},{headers:{Authorization:`Bearer ${token}`}});const purchased=books.find(b=>b._id===bookId);setMessage(`🎉 Welcome & happy reading! Enjoy “${(purchased===null||purchased===void 0?void 0:purchased.title)||'your book'}”.`);setMessageType('success');}catch(err){var _err$response;console.error(((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data)||err.message);setMessage('❌ Error purchasing book');setMessageType('error');}finally{setTimeout(()=>{setMessage('');setMessageType('');},5000);}};useEffect(()=>{let tempBooks=[...books];if(selectedGenre!=='All'){tempBooks=tempBooks.filter(b=>b.genre.toLowerCase()===selectedGenre.toLowerCase());}if(search.trim()){tempBooks=tempBooks.filter(b=>b.title.toLowerCase().includes(search.toLowerCase())||b.author.toLowerCase().includes(search.toLowerCase()));const sug=books.filter(b=>b.title.toLowerCase().includes(search.toLowerCase())||b.author.toLowerCase().includes(search.toLowerCase())).slice(0,5);setSuggestions(sug);}else{setSuggestions([]);}setFilteredBooks(tempBooks);},[search,selectedGenre,books]);useEffect(()=>{fetchBooks();},[]);const genres=['All',...new Set(books.map(b=>b.genre))];return/*#__PURE__*/_jsxs(\"div\",{className:\"book-list neon-bg\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"neon-text\",children:\"\\uD83D\\uDCDA Book Store\"}),message&&/*#__PURE__*/_jsx(\"div\",{className:`floating-message ${messageType}`,children:message}),/*#__PURE__*/_jsxs(\"div\",{className:\"controls neon-box\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search by title or author...\",value:search,onChange:e=>setSearch(e.target.value),className:\"search-input neon-input\"}),/*#__PURE__*/_jsx(\"select\",{value:selectedGenre,onChange:e=>setSelectedGenre(e.target.value),className:\"genre-select neon-select\",children:genres.map((g,i)=>/*#__PURE__*/_jsx(\"option\",{value:g,children:g},i))})]}),suggestions.length>0&&/*#__PURE__*/_jsx(\"ul\",{className:\"suggestions neon-box\",children:suggestions.map(s=>/*#__PURE__*/_jsxs(\"li\",{onClick:()=>setSearch(s.title),children:[s.title,\" \\u2014 \",/*#__PURE__*/_jsx(\"span\",{className:\"author\",children:s.author})]},s._id))}),/*#__PURE__*/_jsx(\"div\",{className:\"books-grid\",children:filteredBooks.length>0?filteredBooks.map(book=>/*#__PURE__*/_jsxs(\"div\",{className:\"book-card neon-card\",children:[/*#__PURE__*/_jsx(\"img\",{src:book.image,alt:book.title,className:\"book-image\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"book-title\",children:book.title}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Author:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{className:\"highlight\",children:book.author})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Genre:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{className:\"highlight\",children:book.genre})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Price:\"}),\" \",/*#__PURE__*/_jsxs(\"span\",{className:\"highlight\",children:[\"$\",book.price]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleBuy(book._id),className:\"buy-btn neon-btn\",children:\"\\uD83D\\uDED2 Buy\"})]},book._id)):/*#__PURE__*/_jsx(\"p\",{className:\"no-books\",children:\"No books found.\"})})]});};export default BookList;","map":{"version":3,"names":["React","useEffect","useState","axios","jsx","_jsx","jsxs","_jsxs","BookList","books","setBooks","filteredBooks","setFilteredBooks","message","setMessage","messageType","setMessageType","search","setSearch","suggestions","setSuggestions","selectedGenre","setSelectedGenre","fetchBooks","res","get","data","err","console","error","handleBuy","bookId","token","localStorage","getItem","post","headers","Authorization","purchased","find","b","_id","title","_err$response","response","setTimeout","tempBooks","filter","genre","toLowerCase","trim","includes","author","sug","slice","genres","Set","map","className","children","type","placeholder","value","onChange","e","target","g","i","length","s","onClick","book","src","image","alt","price"],"sources":["C:/Users/HAZARY/Downloads/mern-web/mern-library/client/src/pages/BookList.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\nimport \"../styles.css\"; // Make sure this includes updated neon styles\r\n\r\nconst BookList = () => {\r\n  const [books, setBooks] = useState([]);\r\n  const [filteredBooks, setFilteredBooks] = useState([]);\r\n  const [message, setMessage] = useState('');\r\n  const [messageType, setMessageType] = useState('');\r\n  const [search, setSearch] = useState('');\r\n  const [suggestions, setSuggestions] = useState([]);\r\n  const [selectedGenre, setSelectedGenre] = useState('All');\r\n\r\n  const fetchBooks = async () => {\r\n    try {\r\n      const res = await axios.get('https://api-fable-forest.onrender.com/api/books');\r\n      setBooks(res.data);\r\n      setFilteredBooks(res.data);\r\n    } catch (err) {\r\n      console.error('Error fetching books:', err);\r\n    }\r\n  };\r\n\r\n  const handleBuy = async (bookId) => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        setMessage('⚠️ You must be logged in to purchase a book.');\r\n        setMessageType('error');\r\n        return;\r\n      }\r\n\r\n      await axios.post(\r\n        'https://api-fable-forest.onrender.com/api/user/buy',\r\n        { bookId },\r\n        {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        }\r\n      );\r\n\r\n      const purchased = books.find((b) => b._id === bookId);\r\n      setMessage(`🎉 Welcome & happy reading! Enjoy “${purchased?.title || 'your book'}”.`);\r\n      setMessageType('success');\r\n    } catch (err) {\r\n      console.error(err.response?.data || err.message);\r\n      setMessage('❌ Error purchasing book');\r\n      setMessageType('error');\r\n    } finally {\r\n      setTimeout(() => {\r\n        setMessage('');\r\n        setMessageType('');\r\n      }, 5000);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    let tempBooks = [...books];\r\n\r\n    if (selectedGenre !== 'All') {\r\n      tempBooks = tempBooks.filter(\r\n        (b) => b.genre.toLowerCase() === selectedGenre.toLowerCase()\r\n      );\r\n    }\r\n\r\n    if (search.trim()) {\r\n      tempBooks = tempBooks.filter(\r\n        (b) =>\r\n          b.title.toLowerCase().includes(search.toLowerCase()) ||\r\n          b.author.toLowerCase().includes(search.toLowerCase())\r\n      );\r\n\r\n      const sug = books\r\n        .filter(\r\n          (b) =>\r\n            b.title.toLowerCase().includes(search.toLowerCase()) ||\r\n            b.author.toLowerCase().includes(search.toLowerCase())\r\n        )\r\n        .slice(0, 5);\r\n      setSuggestions(sug);\r\n    } else {\r\n      setSuggestions([]);\r\n    }\r\n\r\n    setFilteredBooks(tempBooks);\r\n  }, [search, selectedGenre, books]);\r\n\r\n  useEffect(() => {\r\n    fetchBooks();\r\n  }, []);\r\n\r\n  const genres = ['All', ...new Set(books.map((b) => b.genre))];\r\n\r\n  return (\r\n    <div className=\"book-list neon-bg\">\r\n      <h2 className=\"neon-text\">📚 Book Store</h2>\r\n\r\n      {/* Floating message */}\r\n      {message && (\r\n        <div className={`floating-message ${messageType}`}>\r\n          {message}\r\n        </div>\r\n      )}\r\n\r\n      {/* Search + Filter */}\r\n      <div className=\"controls neon-box\">\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Search by title or author...\"\r\n          value={search}\r\n          onChange={(e) => setSearch(e.target.value)}\r\n          className=\"search-input neon-input\"\r\n        />\r\n        <select\r\n          value={selectedGenre}\r\n          onChange={(e) => setSelectedGenre(e.target.value)}\r\n          className=\"genre-select neon-select\"\r\n        >\r\n          {genres.map((g, i) => (\r\n            <option key={i} value={g}>\r\n              {g}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      {/* Suggestions */}\r\n      {suggestions.length > 0 && (\r\n        <ul className=\"suggestions neon-box\">\r\n          {suggestions.map((s) => (\r\n            <li key={s._id} onClick={() => setSearch(s.title)}>\r\n              {s.title} — <span className=\"author\">{s.author}</span>\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      )}\r\n\r\n      {/* Books */}\r\n      <div className=\"books-grid\">\r\n        {filteredBooks.length > 0 ? (\r\n          filteredBooks.map((book) => (\r\n            <div key={book._id} className=\"book-card neon-card\">\r\n              <img src={book.image} alt={book.title} className=\"book-image\" />\r\n              <h4 className=\"book-title\">{book.title}</h4>\r\n              <p><strong>Author:</strong> <span className=\"highlight\">{book.author}</span></p>\r\n              <p><strong>Genre:</strong> <span className=\"highlight\">{book.genre}</span></p>\r\n              <p><strong>Price:</strong> <span className=\"highlight\">${book.price}</span></p>\r\n              <button onClick={() => handleBuy(book._id)} className=\"buy-btn neon-btn\">🛒 Buy</button>\r\n            </div>\r\n          ))\r\n        ) : (\r\n          <p className=\"no-books\">No books found.</p>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BookList;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}